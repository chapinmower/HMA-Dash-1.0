<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Contact Engagement Report - April 2025</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1500px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #105938;
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        h1, h2, h3 {
            color: #105938;
        }
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            flex: 1;
            min-width: 200px;
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .number {
            font-size: 24px;
            font-weight: bold;
            color: #105938;
            margin: 10px 0;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .search-container {
            flex: 2;
            min-width: 300px;
        }
        .filter-container {
            flex: 1;
            min-width: 200px;
        }
        .search-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background-color: white;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #105938;
            color: white;
            position: sticky;
            top: 0;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .status-engaged {
            color: #4CAF50;
            font-weight: bold;
        }
        .status-unengaged {
            color: #F44336;
            font-weight: bold;
        }
        .engagement-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .clicked {
            background-color: #4CAF50;
        }
        .opened {
            background-color: #FFC107;
        }
        .not-opened {
            background-color: #F44336;
        }
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .pagination button {
            padding: 8px 12px;
            border: none;
            background-color: #105938;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        .pagination button:disabled {
            background-color: #ddd;
            cursor: not-allowed;
        }
        .download-btn {
            background-color: #105938;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        .download-btn:hover {
            background-color: #0c4229;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 5px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>April 2025 HMA Team Email Engagement Report</h1>
        <p>Complete Contact Report - All Recipients</p>
    </div>

    <div class="dashboard">
        <div class="stat-card">
            <h3>Total Recipients</h3>
            <div class="number">649</div>
            <p>Across all campaigns</p>
        </div>
        <div class="stat-card">
            <h3>Engaged Contacts</h3>
            <div class="number">414</div>
            <p>Opened or clicked at least one email</p>
        </div>
        <div class="stat-card">
            <h3>Unengaged Contacts</h3>
            <div class="number">235</div>
            <p>Did not open any emails</p>
        </div>
        <div class="stat-card">
            <h3>Overall Engagement Rate</h3>
            <div class="number">63.8%</div>
            <p>Percentage who engaged</p>
        </div>
    </div>
    
    <div class="summary-box" style="background-color: #e8f5e9; border-left: 5px solid #105938; padding: 15px; margin-bottom: 20px;">
        <h3>Important Note About This Demo</h3>
        <p>This is a demonstration version showing a small sample of contacts. In the full implementation, all 649 contacts would be included in the database. For a complete list of all contacts, please use the "Download Full Report" button below.</p>
    </div>

    <button class="download-btn" onclick="downloadCSV()">Download Full Report (CSV)</button>

    <div class="controls">
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="Search by name, email, or campaign...">
        </div>
        <div class="filter-container">
            <select id="statusFilter">
                <option value="all">All Contacts</option>
                <option value="engaged">Engaged Only</option>
                <option value="unengaged">Unengaged Only</option>
            </select>
        </div>
        <div class="filter-container">
            <select id="campaignFilter">
                <option value="all">All Campaigns</option>
                <option value="April Newsletter">April Newsletter</option>
                <option value="ATTN: New Client Portal">Client Portal</option>
                <option value="Well-th Vault Primaries Round 2">Well-th Vault</option>
                <option value="Duplicate of RSVP: June 18 Double Header With HMA!">RSVP Event</option>
            </select>
        </div>
    </div>

    <div class="legend">
        <div class="legend-item">
            <div class="engagement-indicator clicked"></div>
            <span>Clicked</span>
        </div>
        <div class="legend-item">
            <div class="engagement-indicator opened"></div>
            <span>Opened Only</span>
        </div>
        <div class="legend-item">
            <div class="engagement-indicator not-opened"></div>
            <span>Not Opened</span>
        </div>
    </div>

    <table id="contactsTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Status</th>
                <th>April Newsletter</th>
                <th>Client Portal</th>
                <th>Well-th Vault</th>
                <th>RSVP Event</th>
                <th>Engagement Score</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated by JavaScript -->
        </tbody>
    </table>
    
    <div class="pagination" id="pagination">
        <!-- Pagination buttons will be added by JavaScript -->
    </div>

    <script>
        // Sample data - this would be generated from your full contact list
        const contactData = [
            // Engaged contacts
            {
                firstName: "Jamie", 
                lastName: "Harper", 
                email: "jamie.harper1@comcast.net", 
                status: "engaged",
                engagementScore: 25,
                campaigns: {
                    "April Newsletter": "clicked",
                    "ATTN: New Client Portal": "opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "clicked"
                }
            },
            {
                firstName: "Donna", 
                lastName: "Harper", 
                email: "jdjl.harper@comcast.net", 
                status: "engaged",
                engagementScore: 25,
                campaigns: {
                    "April Newsletter": "clicked",
                    "ATTN: New Client Portal": "opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "clicked"
                }
            },
            {
                firstName: "John", 
                lastName: "Drennan", 
                email: "jpdren1@gmail.com", 
                status: "engaged",
                engagementScore: 20,
                campaigns: {
                    "April Newsletter": "opened",
                    "ATTN: New Client Portal": "opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "clicked"
                }
            },
            {
                firstName: "Susan", 
                lastName: "Barclay", 
                email: "barclays2001@yahoo.com", 
                status: "engaged",
                engagementScore: 15,
                campaigns: {
                    "April Newsletter": "opened",
                    "ATTN: New Client Portal": "opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "opened"
                }
            },
            {
                firstName: "Ryan", 
                lastName: "Ross", 
                email: "ryjross@gmail.com", 
                status: "engaged",
                engagementScore: 10,
                campaigns: {
                    "April Newsletter": "opened",
                    "ATTN: New Client Portal": "opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-sent"
                }
            },
            // Unengaged contacts
            {
                firstName: "Mr.", 
                lastName: "Adelmann", 
                email: "jadelmann@openlands.com", 
                status: "unengaged",
                engagementScore: 0,
                campaigns: {
                    "April Newsletter": "not-opened",
                    "ATTN: New Client Portal": "not-sent",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-sent"
                }
            },
            {
                firstName: "Neo", 
                lastName: "Ahuja", 
                email: "nishchay.ahuja@togrp.com", 
                status: "unengaged",
                engagementScore: 0,
                campaigns: {
                    "April Newsletter": "not-opened",
                    "ATTN: New Client Portal": "not-sent",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-sent"
                }
            },
            {
                firstName: "Joe", 
                lastName: "Arnold", 
                email: "josephcarnold@hotmail.com", 
                status: "unengaged",
                engagementScore: 0,
                campaigns: {
                    "April Newsletter": "not-opened",
                    "ATTN: New Client Portal": "not-sent",
                    "Well-th Vault Primaries Round 2": "not-opened",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-opened"
                }
            },
            {
                firstName: "Dennis", 
                lastName: "Johnson", 
                email: "djjohnson929@gmail.com", 
                status: "unengaged",
                engagementScore: 0,
                campaigns: {
                    "April Newsletter": "not-opened",
                    "ATTN: New Client Portal": "not-opened",
                    "Well-th Vault Primaries Round 2": "not-opened",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-sent"
                }
            },
            {
                firstName: "Grove", 
                lastName: "Mower", 
                email: "grove@hummermower.com", 
                status: "unengaged",
                engagementScore: 0,
                campaigns: {
                    "April Newsletter": "not-opened",
                    "ATTN: New Client Portal": "not-opened",
                    "Well-th Vault Primaries Round 2": "not-sent",
                    "Duplicate of RSVP: June 18 Double Header With HMA!": "not-sent"
                }
            }
            // In a real implementation, this would include all 649 contacts
        ];

        // Variables for pagination
        const rowsPerPage = 10;
        let currentPage = 1;
        let filteredData = [...contactData];

        // Initialize the table
        function initializeTable() {
            // Set up event listeners
            document.getElementById('searchInput').addEventListener('keyup', filterContacts);
            document.getElementById('statusFilter').addEventListener('change', filterContacts);
            document.getElementById('campaignFilter').addEventListener('change', filterContacts);
            
            // Initial load
            filterContacts();
        }

        // Filter contacts based on search input and dropdown selections
        function filterContacts() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const campaignFilter = document.getElementById('campaignFilter').value;
            
            filteredData = contactData.filter(contact => {
                // Search text filter
                const nameMatch = `${contact.firstName} ${contact.lastName}`.toLowerCase().includes(searchText);
                const emailMatch = contact.email.toLowerCase().includes(searchText);
                const textMatch = nameMatch || emailMatch;
                
                // Status filter
                const statusMatch = statusFilter === 'all' || 
                                   (statusFilter === 'engaged' && contact.status === 'engaged') ||
                                   (statusFilter === 'unengaged' && contact.status === 'unengaged');
                
                // Campaign filter
                let campaignMatch = true;
                if (campaignFilter !== 'all') {
                    // Only include contacts who received the selected campaign
                    campaignMatch = contact.campaigns[campaignFilter] !== 'not-sent';
                }
                
                return textMatch && statusMatch && campaignMatch;
            });
            
            // Reset to first page when filtering
            currentPage = 1;
            
            // Update the table and pagination
            renderTable();
            renderPagination();
        }

        // Render the table with current filtered data and pagination
        function renderTable() {
            const tableBody = document.querySelector('#contactsTable tbody');
            tableBody.innerHTML = '';
            
            const startIndex = (currentPage - 1) * rowsPerPage;
            const endIndex = Math.min(startIndex + rowsPerPage, filteredData.length);
            
            for (let i = startIndex; i < endIndex; i++) {
                const contact = filteredData[i];
                const row = document.createElement('tr');
                
                // Name column
                const nameCell = document.createElement('td');
                nameCell.textContent = `${contact.firstName} ${contact.lastName}`;
                row.appendChild(nameCell);
                
                // Email column
                const emailCell = document.createElement('td');
                emailCell.textContent = contact.email;
                row.appendChild(emailCell);
                
                // Status column
                const statusCell = document.createElement('td');
                if (contact.status === 'engaged') {
                    statusCell.textContent = 'Engaged';
                    statusCell.className = 'status-engaged';
                } else {
                    statusCell.textContent = 'Unengaged';
                    statusCell.className = 'status-unengaged';
                }
                row.appendChild(statusCell);
                
                // Campaign columns
                const campaigns = [
                    "April Newsletter", 
                    "ATTN: New Client Portal", 
                    "Well-th Vault Primaries Round 2", 
                    "Duplicate of RSVP: June 18 Double Header With HMA!"
                ];
                
                campaigns.forEach(campaign => {
                    const campaignCell = document.createElement('td');
                    const status = contact.campaigns[campaign];
                    
                    if (status === 'not-sent') {
                        campaignCell.textContent = 'Not Sent';
                    } else {
                        const indicator = document.createElement('div');
                        indicator.className = `engagement-indicator ${status}`;
                        campaignCell.appendChild(indicator);
                        
                        if (status === 'clicked') {
                            campaignCell.appendChild(document.createTextNode('Clicked'));
                        } else if (status === 'opened') {
                            campaignCell.appendChild(document.createTextNode('Opened'));
                        } else {
                            campaignCell.appendChild(document.createTextNode('Not Opened'));
                        }
                    }
                    
                    row.appendChild(campaignCell);
                });
                
                // Engagement score column
                const scoreCell = document.createElement('td');
                scoreCell.textContent = contact.engagementScore;
                row.appendChild(scoreCell);
                
                tableBody.appendChild(row);
            }
        }

        // Render pagination controls
        function renderPagination() {
            const paginationDiv = document.getElementById('pagination');
            paginationDiv.innerHTML = '';
            
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            
            // Add text showing current results
            const resultInfo = document.createElement('span');
            resultInfo.textContent = `Showing ${filteredData.length} contacts`;
            paginationDiv.appendChild(resultInfo);
            
            // Previous button
            const prevButton = document.createElement('button');
            prevButton.textContent = 'Previous';
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTable();
                    renderPagination();
                }
            });
            paginationDiv.appendChild(prevButton);
            
            // Page text
            const pageText = document.createElement('span');
            pageText.textContent = `Page ${currentPage} of ${totalPages || 1}`;
            paginationDiv.appendChild(pageText);
            
            // Next button
            const nextButton = document.createElement('button');
            nextButton.textContent = 'Next';
            nextButton.disabled = currentPage >= totalPages;
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTable();
                    renderPagination();
                }
            });
            paginationDiv.appendChild(nextButton);
        }
        
        // Download CSV function
        function downloadCSV() {
            // In a real implementation, this would include all 649 contacts
            // For this demo, we'll create a more comprehensive sample CSV
            
            // Create CSV header
            let csvContent = "First Name,Last Name,Email,Status,April Newsletter,Client Portal,Well-th Vault,RSVP Event,Engagement Score\n";
            
            // Add message about the full dataset
            csvContent += "NOTE: This is a sample CSV. The full implementation would include all 649 contacts.\n\n";
            
            // Include existing sample data
            contactData.forEach(contact => {
                // Convert campaign status to simpler text for CSV
                const aprilStatus = convertStatusForCSV(contact.campaigns["April Newsletter"]);
                const portalStatus = convertStatusForCSV(contact.campaigns["ATTN: New Client Portal"]);
                const vaultStatus = convertStatusForCSV(contact.campaigns["Well-th Vault Primaries Round 2"]);
                const rsvpStatus = convertStatusForCSV(contact.campaigns["Duplicate of RSVP: June 18 Double Header With HMA!"]);
                
                // Format CSV row
                csvContent += `"${contact.firstName}","${contact.lastName}","${contact.email}","${contact.status}","${aprilStatus}","${portalStatus}","${vaultStatus}","${rsvpStatus}","${contact.engagementScore}"\n`;
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', 'sample_contact_report_april_2025.csv');
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show message about complete data
            alert("In a full implementation, this would download a complete CSV with all 649 contacts.\n\nFor complete data, please combine the previously provided CSV files:");
        }
        
        // Helper function to convert status to CSV-friendly text
        function convertStatusForCSV(status) {
            switch(status) {
                case 'clicked': return 'Clicked';
                case 'opened': return 'Opened';
                case 'not-opened': return 'Not Opened';
                case 'not-sent': return 'Not Sent';
                default: return '';
            }
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', initializeTable);
    </script>
</body>
</html>